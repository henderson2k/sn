async function getPage1() {
      const res = await fetch('https://nhsscotland.service-now.com/incident.do?JSONv2&sysparm_action=getRecords&sysparm_query=sys_id=9992fe9f1b8e2994fa6aa822b24bcb7a&displayvariables=true')
      Page1 = await res.json();
    
    console.log(Page1)
    }

await getPage1()

https://nhsscotland.service-now.com/task_list.do?sysparm_clear_stack=true&sysparm_nostack=true&sysparm_query=assigned_to%3Db1daee481be7c4908a04c84b1d4bcbaa%5Eactive%3Dtrue%5EnumberNOT%20LIKEREQ%5Estate!%3D6%5EGROUPBYstate&sysparm_first_row=1&sysparm_view=

Request details

https://nhsscotland.service-now.com/sc_req_item.do?JSONv2&sysparm_action=getRecords&sysparm_query=sys_id=877ddec91b8ea914a1cbedb2b24bcb4a&displayvariables=true

877ddec91b8ea914a1cbedb2b24bcb4a

Incident details

https://nhsscotland.service-now.com/incident.do?JSONv2&sysparm_action=getRecords&sysparm_query=sys_id=9992fe9f1b8e2994fa6aa822b24bcb7a&displayvariables=true

Computer Asset details

https://nhsscotland.service-now.com/cmdb_ci_computer.do?JSONv2&sysparm_action=getRecords&sysparm_query=sys_id=4bf403181b2fc0d08a04c84b1d4bcbfc&displayvariables=true



async function getPage1() {
  const data1 = await fetch('https://nhsscotland.service-now.com/task_list.do?JSONv2&sysparm_clear_stack=true&sysparm_nostack=true&sysparm_query=assigned_to%3Db1daee481be7c4908a04c84b1d4bcbaa%5Eactive%3Dtrue%5EnumberNOT%20LIKEREQ%5Estate!%3D6%5EGROUPBYstate&sysparm_first_row=1&sysparm_view=');
  const data = await data1.json();

  console.log(data);

  const searchKey = "task_effective_number";
  const additionalKeys = ["sys_id", "state"];
  const foundValues = [];

  for (let i = 0; i < data.records.length; i++) {
    const record = data.records[i];
    if (record.hasOwnProperty(searchKey)) {
      const foundValue = {
        [searchKey]: record[searchKey]
      };
      additionalKeys.forEach(key => {
        if (record.hasOwnProperty(key)) {
          foundValue[key] = record[key];
        }
      });
      foundValues.push(foundValue);
    }
  }

  if (foundValues.length === 0) {
    console.log("Key not found");
  } else {
    console.log(foundValues);
  }
}

await getPage1();
